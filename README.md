2 Вариант написанный по вашему техническому заданию. В нём есть ошибка по памяти при сортировке.

Поддерживает только англиский язык, для поддержки кирилицы нужно выделять будет не 1 а 2 байта на символ.
